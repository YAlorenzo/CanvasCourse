<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
        body{
            text-align: center;
        }
      #myCanvas {
        position: absolute;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
        border: 1px solid;
      }
    </style>
  </head>
  <body>
    <canvas id="myCanvas" width="400" height="400"></canvas>
    <label for="speedSlider">SPEED</label>
    <br/>
    <input
      type="range"
      id="speedSlider"
      min="0"
      step="0.1"
      max="4"
      value="0"
      oninput="updateRotationSpeed()"
    />

    <script>
      const context = myCanvas.getContext("2d");
      let drawing = false;
      let rotationAngle = 0;
      let rotationSpeed = 0;
      let eventInfo = null;

      myCanvas.addEventListener("pointerdown", (e) => {
        context.beginPath();
        context.moveTo(e.offsetX, e.offsetY);
        drawing = true;
      });

      myCanvas.addEventListener("pointermove", (e) => {
        eventInfo = e;
      });

      myCanvas.addEventListener("pointerleave", () => {
        drawing = false;
      });
      myCanvas.addEventListener("pointerup", () => {
        drawing = false;
      });

      animate();

      function animate() {
        rotationAngle += rotationSpeed;
        myCanvas.style.transform =
          "translate(-50%, -50%) rotate(" + rotationAngle + "deg)";

        if (drawing == true && eventInfo) {
          const xyRelToCenterPage = {
            x: eventInfo.pageX - window.innerWidth / 2,
            y: eventInfo.pageY - window.innerHeight / 2,
          };
          const pol = toPolar(xyRelToCenterPage);
          pol.dir -= rotationAngle * (Math.PI / 180);
          const xyWithRotation = toXY(pol);
          xyWithRotation.x += myCanvas.width / 2;
          xyWithRotation.y += myCanvas.height / 2;
          context.lineTo(xyWithRotation.x, xyWithRotation.y);
          context.stroke();
          context.beginPath();
          context.moveTo(xyWithRotation.x, xyWithRotation.y);
        }
        requestAnimationFrame(animate);
      }

      function toPolar({ x, y }) {
        return {
          dir: Math.atan2(y, x),
          mag: Math.hypot(x, y),
        };
      }
      function toXY({ mag, dir }) {
        return {
          x: Math.cos(dir) * mag,
          y: Math.sin(dir) * mag,
        };
      }
      function updateRotationSpeed() {
    
        rotationSpeed = parseFloat(
          document.getElementById("speedSlider").value
        );
        console.log(rotationSpeed);
      }
    </script>
  </body>
</html>
